# coca_coda Inference Application

This project contains an Inference Application that takes **input images** from users, either as files or webcam captures, and **generates a label** for the image regarding the **presence of a coke bottle** in the image, or lack thereof. If there is a coke bottle present, a boundary is drawn around the bottle.

### Initial Labeling:

+ First, the initial dataset of **100 images**, 50 containing coke bottles and 50 without, was **hand-labeled** using ![https://www.labelbox.com](Labelbox).
+ Boundaries were drawn around the coke bottles

### Preprocessing & Data Augmentation:

`data_aug.py`: the hand-labeled dataset is converted from 100 **to 24,000 images and labels**.

+ First, the images were resized.
    + The images from the `no_coke` class have black vertical boundaries on either side; those are removed
    + The images containing coke bottles are a different size from the images without coke bottles, so images from each class are duplicated and one of the copies is converted to the size of the other class's images. This produced images of **two different resolutions** for each image.
+ Next, **6 translations** are obtained for each image.
    + For the `coke` class, if the coke bottle's principal direction is in the x-axis, then one translation is made along this axis and two translations are made along the y-axis (and vice versa if the principal direction is along the y-axis)
    + The boundary around the coke bottle, if present, is used to determine the magnitude of translation, so as to keep the object in tact.
+ The RGB channels of the images are **inverted** to BGR.
+ Each image is **rotated** 90, 180, and 270 degrees.

### Labeling the full dataset:

+ Labelbox exports labeled images to both `.json` format and a format required for the Coco deep learning model, and can convert between its `.json` exports and its exports for Coco.
+ Instead of hand labeling all of the 24,000 images, the images are loaded into Labelbox and the labels are automatically skipped for each image using the `index.html` file in the `labelox/` directory.
+ Next, the labels generated in the Augmentation step are inserted into the `.json` file generated by Labelbox, and the `.json` file is converted to the Coco format using `json_to_coco.py`.

### Transfer Learning-Based Inference

+ The **pre-trained Coco deep learning model** is used to build an inference model for the coca-cola dataset.
